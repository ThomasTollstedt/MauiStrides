<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:vm="clr-namespace:MauiStrides.ViewModels"
             xmlns:models="clr-namespace:MauiStrides.Models"
             x:Class="MauiStrides.Views.ActivityDetailsPage"
             x:DataType="vm:ActivityDetailsViewModel"
             Title="Activity Details"
             BackgroundColor="{StaticResource AppBackground}">

    <ScrollView>
        <VerticalStackLayout Spacing="{OnIdiom Phone='15', Default='20'}" 
                             Padding="{OnIdiom Phone='15', Default='20'}">

            <!-- HEADER CARD -->
            <Border Style="{StaticResource ActivityCardStyle}">
                <Grid ColumnDefinitions="Auto, *" ColumnSpacing="15">

                    <Border Grid.Column="0" 
                            Style="{StaticResource IconBoxStyle}" 
                            WidthRequest="{OnIdiom Phone='50', Default='60'}" 
                            HeightRequest="{OnIdiom Phone='50', Default='60'}">
                        <Label Text="{Binding Activity.SportIcon}" 
                               FontSize="{OnIdiom Phone='28', Default='32'}"
                               HorizontalOptions="Center" 
                               VerticalOptions="Center"/>
                    </Border>

                    <VerticalStackLayout Grid.Column="1" VerticalOptions="Center" Spacing="5">
                        <Label Text="{Binding Activity.Name}" 
                               FontSize="{OnIdiom Phone='18', Default='20'}" 
                               FontAttributes="Bold"
                               TextColor="{StaticResource AppText}"
                               LineBreakMode="WordWrap"/>
                        <Label Text="{Binding Activity.DateDisplay}" 
                               FontSize="{OnIdiom Phone='12', Default='14'}"
                               TextColor="{StaticResource AppSecondary}"/>
                    </VerticalStackLayout>

                </Grid>
            </Border>

            <!-- STORY CARD -->
            <Border Style="{StaticResource ActivityCardStyle}">
                <VerticalStackLayout Spacing="10" Padding="{OnIdiom Phone='8', Default='10'}">
                    <Label FontSize="{OnIdiom Phone='14', Default='16'}" 
                           LineBreakMode="WordWrap"
                           TextColor="{StaticResource AppText}"
                           HorizontalTextAlignment="Center">
                        <Label.FormattedText>
                            <FormattedString>
                                <Span Text="You had a delightful trip of " />
                                <Span Text="{Binding Activity.DistanceKm}" 
                                      FontAttributes="Bold"
                                      TextColor="{StaticResource AppPrimary}"/>
                                <Span Text=" taking you through scenery for " />
                                <Span Text="{Binding Activity.TimeDisplay}" 
                                      FontAttributes="Bold"
                                      TextColor="{StaticResource AppPrimary}"/>
                                <Span Text=" and the mountains answered with their raggedness with " />
                                <Span Text="{Binding Activity.ElevationDisplay}" 
                                      FontAttributes="Bold"
                                      TextColor="{StaticResource AppPrimary}"/>
                                <Span Text=" of climbing. " />

                                <Span Text="Making your heart work a bit harder: " />
                                <Span Text=""/>
                                <Span Text="{Binding Activity.HeartrateDisplay}" 
                                        FontAttributes="Bold"
                                        TextColor="{StaticResource AppPrimary}"/>
                                <Span Text=" avg. Ending up with you generating a total of " />
                                <Span Text="{Binding Activity.KiloJoules}" 
                                      FontAttributes="Bold"
                                      TextColor="{StaticResource AppPrimary}"/>
                                <Span Text="kJ of work. Great job! ðŸ¤¸â€ " />
                            </FormattedString>
                        </Label.FormattedText>
                    </Label>
                </VerticalStackLayout>
            </Border>

            <!-- PRIMARY STATS -->
            <Border Style="{StaticResource ActivityCardStyle}">
                <Grid ColumnDefinitions="*, *, *" 
                      RowDefinitions="Auto, Auto" 
                      RowSpacing="{OnIdiom Phone='15', Default='20'}"
                      ColumnSpacing="{OnIdiom Phone='5', Default='10'}">

                    <!-- Distance -->
                    <VerticalStackLayout Grid.Column="0" Style="{StaticResource MetricContainerStyle}">
                        <Label Text="ðŸ" FontSize="{OnIdiom Phone='20', Default='24'}" HorizontalOptions="Center"/>
                        <Label Text="{Binding Activity.DistanceKm}" 
                               FontSize="{OnIdiom Phone='16', Default='14'}"
                               FontAttributes="Bold"
                               TextColor="{StaticResource AppText}"
                               HorizontalOptions="Center"/>
                        <Label Text="Distance" Style="{StaticResource MetricLabelStyle}"/>
                    </VerticalStackLayout>

                    <!-- Moving Time -->
                    <VerticalStackLayout Grid.Column="1" Style="{StaticResource MetricContainerStyle}">
                        <Label Text="â±ï¸" FontSize="{OnIdiom Phone='20', Default='24'}" HorizontalOptions="Center"/>
                        <Label Text="{Binding Activity.TimeDisplay}" 
                               FontSize="{OnIdiom Phone='16', Default='14'}"
                               FontAttributes="Bold"
                               TextColor="{StaticResource AppText}"
                               HorizontalOptions="Center"/>
                        <Label Text="Time" Style="{StaticResource MetricLabelStyle}"/>
                    </VerticalStackLayout>

                    <!-- Elevation -->
                    <VerticalStackLayout Grid.Column="2" Style="{StaticResource MetricContainerStyle}">
                        <Label Text="â›°ï¸" FontSize="{OnIdiom Phone='20', Default='24'}" HorizontalOptions="Center"/>
                        <Label Text="{Binding Activity.ElevationDisplay}" 
                               FontSize="{OnIdiom Phone='16', Default='14'}"
                               FontAttributes="Bold"
                               TextColor="{StaticResource AppText}"
                               HorizontalOptions="Center"/>
                        <Label Text="Elevation" Style="{StaticResource MetricLabelStyle}"/>
                    </VerticalStackLayout>

                    <!-- Pace -->
                    <VerticalStackLayout Grid.Row="1" Grid.Column="0" Style="{StaticResource MetricContainerStyle}">
                        <Label Text="âš¡" FontSize="{OnIdiom Phone='20', Default='24'}" HorizontalOptions="Center"/>
                        <Label Text="{Binding Activity.PaceDisplay}" 
                               FontSize="{OnIdiom Phone='16', Default='14'}"
                               FontAttributes="Bold"
                               TextColor="{StaticResource AppText}"
                               HorizontalOptions="Center"/>
                        <Label Text="Pace" Style="{StaticResource MetricLabelStyle}"/>
                    </VerticalStackLayout>

                    <!-- Average Speed -->
                    <VerticalStackLayout Grid.Row="1" Grid.Column="1" Style="{StaticResource MetricContainerStyle}">
                        <Label Text="ðŸ’¨" FontSize="{OnIdiom Phone='20', Default='24'}" HorizontalOptions="Center"/>
                        <Label Text="{Binding Activity.AverageSpeedDisplay}" 
                               FontSize="{OnIdiom Phone='16', Default='14'}"
                               FontAttributes="Bold"
                               TextColor="{StaticResource AppText}"
                               HorizontalOptions="Center"/>
                        <Label Text="Avg Speed" Style="{StaticResource MetricLabelStyle}"/>
                    </VerticalStackLayout>

                    <!-- Max Speed -->
                    <VerticalStackLayout Grid.Row="1" Grid.Column="2" Style="{StaticResource MetricContainerStyle}">
                        <Label Text="ðŸš€" FontSize="{OnIdiom Phone='20', Default='24'}" HorizontalOptions="Center"/>
                        <Label Text="{Binding Activity.MaxSpeedDisplay}" 
                               FontSize="{OnIdiom Phone='16', Default='14'}"
                               FontAttributes="Bold"
                               TextColor="{StaticResource AppText}"
                               HorizontalOptions="Center"/>
                        <Label Text="Max Speed" Style="{StaticResource MetricLabelStyle}"/>
                    </VerticalStackLayout>

                </Grid>
            </Border>

            <!-- PERFORMANCE METRICS -->
            <Border Style="{StaticResource ActivityCardStyle}">
                <VerticalStackLayout Spacing="15">

                    <Label Text="" Style="{StaticResource SectionHeaderStyle}"/>

                    <Grid ColumnDefinitions="*, *" 
                          RowDefinitions="Auto, Auto"
                          RowSpacing="12" 
                          ColumnSpacing="4">

                        <!-- Heart Rate -->
                        <VerticalStackLayout Grid.Row="0" Grid.Column="0" Style="{StaticResource MetricContainerStyle}">
                            <Label Text="â¤ï¸" Style="{StaticResource MetricEmojiStyle}"/>
                            <Label Text="{Binding Activity.HeartrateDisplay}" Style="{StaticResource MetricValueStyle}"/>
                            <Label Text="HR" Style="{StaticResource MetricLabelStyle}"/>
                        </VerticalStackLayout>

                        <!-- Cadence -->
                        <VerticalStackLayout Grid.Row="0" Grid.Column="1" Style="{StaticResource MetricContainerStyle}">
                            <Label Text="ðŸ”„" Style="{StaticResource MetricEmojiStyle}"/>
                            <Label Text="{Binding Activity.CadenceDisplay}" Style="{StaticResource MetricValueStyle}"/>
                            <Label Text="Cadence" Style="{StaticResource MetricLabelStyle}"/>
                        </VerticalStackLayout>

                        <!-- Power -->
                        <VerticalStackLayout Grid.Row="1" Grid.Column="0" Style="{StaticResource MetricContainerStyle}">
                            <Label Text="âš¡" Style="{StaticResource MetricEmojiStyle}"/>
                            <Label Text="{Binding Activity.PowerDisplay}" Style="{StaticResource MetricValueStyle}"/>
                            <Label Text="Power" Style="{StaticResource MetricLabelStyle}"/>
                        </VerticalStackLayout>

                        <!-- Work kJ -->
                        <VerticalStackLayout Grid.Row="1" Grid.Column="1" Style="{StaticResource MetricContainerStyle}">
                            <Label Text="ðŸ”¥" Style="{StaticResource MetricEmojiStyle}"/>
                            <Label Text="{Binding Activity.kJDisplay}" Style="{StaticResource MetricValueStyle}"/>
                            <Label Text="kJ" Style="{StaticResource MetricLabelStyle}"/>
                        </VerticalStackLayout>

                    </Grid>

                </VerticalStackLayout>
            </Border>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>
