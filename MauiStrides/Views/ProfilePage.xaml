<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:models="clr-namespace:MauiStrides.Models"
             xmlns:vm="clr-namespace:MauiStrides.ViewModels"
             x:Class="MauiStrides.Views.ProfilePage"
             Title="Profile"
             BackgroundColor="{StaticResource AppBackground}">

    <ScrollView>
        <VerticalStackLayout Padding="15" Spacing="15">

            <!-- Profile Header Section -->
            <Grid ColumnDefinitions="Auto, *" ColumnSpacing="12">

                <!-- Profile Picture -->
                <Border Grid.Column="0" 
                        StrokeShape="RoundRectangle 40" 
                        HeightRequest="80" 
                        WidthRequest="80" 
                        StrokeThickness="0">
                    <Image Source="{Binding CurrentAthleteProfile.Profile}" 
                           Aspect="AspectFill"/>
                </Border>

                <!-- Name and Location Info -->
                <VerticalStackLayout Grid.Column="1" 
                                     Spacing="6" 
                                     VerticalOptions="Center">

                    <!-- Full Name -->
                    <Label FontSize="18" 
                           FontAttributes="Bold"
                           TextColor="{StaticResource AppText}">
                        <Label.Text>
                            <MultiBinding StringFormat="{}{0} {1}">
                                <Binding Path="CurrentAthleteProfile.FirstName" />
                                <Binding Path="CurrentAthleteProfile.LastName" />
                            </MultiBinding>
                        </Label.Text>
                    </Label>

                    <!-- Bio -->
                    <Label Text="{Binding CurrentAthleteProfile.Bio}" 
                           FontSize="13"
                           LineBreakMode="TailTruncation"
                           MaxLines="2"
                           TextColor="{StaticResource AppPrimary}"/>

                    <!-- City, Country -->
                    <HorizontalStackLayout Spacing="4">
                        <Label Text="ðŸ“" FontSize="12"/>
                        <Label FontSize="12" 
                               TextColor="{StaticResource AppSecondary}">
                            <Label.Text>
                                <MultiBinding StringFormat="{}{0}, {1}">
                                    <Binding Path="CurrentAthleteProfile.City" />
                                    <Binding Path="CurrentAthleteProfile.Country" />
                                </MultiBinding>
                            </Label.Text>
                        </Label>
                    </HorizontalStackLayout>

                </VerticalStackLayout>
            </Grid>

            <!-- Overall Stats Grid Card -->
            <Border Style="{StaticResource ActivityCardStyle}" 
                    Padding="15">
                <Grid ColumnDefinitions="*, *, *" 
                      ColumnSpacing="8">

                    <!-- Activity Count -->
                    <VerticalStackLayout Grid.Column="0" 
                                         Spacing="4" 
                                         HorizontalOptions="Center">
                        <Label Text="{Binding CurrentMonthActivityCount}" 
                               FontSize="28" 
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource AppPrimary}"/>
                        <Label Text="Activities" 
                               FontSize="10"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource AppSecondary}"/>
                    </VerticalStackLayout>

                    <!-- Total Hours -->
                    <VerticalStackLayout Grid.Column="1" 
                                         Spacing="4" 
                                         HorizontalOptions="Center">
                        <Label Text="{Binding CurrentMonthTotalDuration, StringFormat='{0:F1}'}" 
                               FontSize="28" 
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource AppPrimary}"/>
                        <Label Text="Hours" 
                               FontSize="10"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource AppSecondary}"/>
                    </VerticalStackLayout>

                    <!-- Total Distance -->
                    <VerticalStackLayout Grid.Column="2" 
                                         Spacing="4" 
                                         HorizontalOptions="Center">
                        <Label Text="{Binding CurrentMonthTotalDistance, StringFormat='{0:F0}'}" 
                               FontSize="28" 
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource AppPrimary}"/>
                        <Label Text="km" 
                               FontSize="10"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource AppSecondary}"/>
                    </VerticalStackLayout>

                </Grid>
            </Border>

            <!-- Activity Types Card -->    
            <Border Style="{StaticResource ActivityCardStyle}" 
                    Padding="15">
                <Grid ColumnDefinitions="*, *, *" 
                      ColumnSpacing="8">

                    <!-- Run Count -->
                    <VerticalStackLayout Grid.Column="0" 
                                         Spacing="4" 
                                         HorizontalOptions="Center">
                        <Label Text="{Binding CurrentMonthRunCount}" 
                               FontSize="28" 
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource AppPrimary}"/>
                        <Label Text="ðŸƒâ€" 
                               FontSize="16"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource AppSecondary}"/>
                    </VerticalStackLayout>

                    <!-- Ride Count -->
                    <VerticalStackLayout Grid.Column="1" 
                                         Spacing="4" 
                                         HorizontalOptions="Center">
                        <Label Text="{Binding CurrentMonthRideCount}" 
                               FontSize="28" 
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource AppPrimary}"/>
                        <Label Text="ðŸš´" 
                               FontSize="16"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource AppSecondary}"/>
                    </VerticalStackLayout>

                    <!-- Virtual Ride Count -->
                    <VerticalStackLayout Grid.Column="2" 
                                         Spacing="4" 
                                         HorizontalOptions="Center">
                        <Label Text="{Binding CurrentMonthVirtualRideCount}" 
                               FontSize="28" 
                               FontAttributes="Bold"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource AppPrimary}"/>
                        <Label Text="ðŸŽ®" 
                               FontSize="16"
                               HorizontalOptions="Center"
                               TextColor="{StaticResource AppSecondary}"/>
                    </VerticalStackLayout>

                </Grid>
            </Border>

            <!-- Logout Button -->
            <Button Text="Logout"
                    Command="{Binding LogoutCommand}"
                    BackgroundColor="{StaticResource AppSecondary}"
                    TextColor="White"
                    Margin="0,10,0,0"
                    HorizontalOptions="Fill"/>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>